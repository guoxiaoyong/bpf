
#include <bpf_emu.h>
#include <bpf_asm.h>

uint8_t pack[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x08, 0x06, 0x00, 0x01,
    0x08, 0x00, 0x06, 0x04, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00,
    0x00, 0x00
};

#define CREATE_VM(in, code) vm in(code, sizeof(code)/sizeof(code[0]))
int main()
{
    using namespace bpf;
    CREATE_VM(TAKAHITO, pgm_tcp);
    TAKAHITO.run(pack, sizeof(pack));
}

